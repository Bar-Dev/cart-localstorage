{"version":3,"file":"cart-localstorage.min.js","sources":["../utils/localstorage.js","../index.js"],"sourcesContent":["const STORAGE_KEY = '__cart'\n\nlet saveListener = null;\nexport const listen = (cb) => { saveListener = cb }; // ugly but storage listener is not working for the same window..\n\nexport const list = (key) => JSON.parse(localStorage.getItem(key || STORAGE_KEY)) || [];\n\nexport const save = (data, key) => {\n\tlocalStorage.setItem(key || STORAGE_KEY, JSON.stringify(data));\n\tif(saveListener) saveListener(list(key || STORAGE_KEY))\n}\n\nexport const clear = (key) => {\n\tlocalStorage.removeItem(key || STORAGE_KEY)\n\tif(saveListener) saveListener(list(key || STORAGE_KEY))\n}\n","import { list, save, clear, listen } from './utils/localstorage'\n\nconst get = (id) => list().find((product) => product.id === id)\n\nconst exists = (id) => !!get(id)\n\nconst add = (product, quantity) => isValid(product) ? exists(product.id) ? update(product.id, 'quantity', get(product.id).quantity + (quantity || 1)) : save(list().concat({ ...product, quantity: quantity || 1 })) : null;\n\nconst remove = (id) => save(list().filter((product) => product.id !== id))\n\nconst quantity = (id, diff) => exists(id) && get(id).quantity + diff >= 0 ? update(id, 'quantity', get(id).quantity + diff) : remove(id);\n\nconst update = (id, field, value) => save(list().map((product) => product.id === id ? ({ ...product, [field]: value }) : product))\n\nconst total = (cb) => list().reduce((sum, product) => isCallback(cb) ? cb(sum, product) : (sum += subtotal(product)), 0);\n\nconst destroy = () => clear()\n\nconst onChange = (cb) => isCallback(cb) ? listen(cb) : console.log(typeof cb)\n\n\nconst isValid = (product) => product.id && product.price\n\nconst subtotal = (product) => isCalcable(product) ? (product.price * product.quantity) : 0\n\nconst isCalcable = (product) => (product && product.price && product.quantity)\n\nconst isCallback = (cb) => cb && typeof cb === \"function\"\n\nexport { list, get, add, remove, update, quantity, total, destroy, exists, subtotal, onChange };\n"],"names":["saveListener","listen","cb","list","key","JSON","parse","localStorage","getItem","save","data","setItem","stringify","clear","removeItem","get","id","find","product","exists","remove","filter","update","field","value","map","onChange","isCallback","console","log","isValid","price","subtotal","isCalcable","quantity","concat","diff","reduce","sum"],"mappings":"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"}